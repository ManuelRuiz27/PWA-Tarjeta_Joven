FROM node:20.16-alpine
WORKDIR /app

# Instala deps (aprovecha cache si solo cambia código)
COPY package.json package-lock.json* ./
RUN if [ -f package-lock.json ]; then npm ci; else npm install; fi

# Variables útiles para hot reload en contenedores
ENV HOST=0.0.0.0 \
    VITE_API_BASE=/api \
    CHOKIDAR_USEPOLLING=true \
    WATCHPACK_POLLING=true

# Copia fuentes (en compose-dev se montan como volumen)
COPY . .

EXPOSE 5173
CMD ["npm", "run", "dev"]

